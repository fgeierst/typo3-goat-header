@use '../base/breakpoints';

/*
*  .mainnav
*      ├─ item
*      │   ├── toggle-button
*      │   │     └─ icon
*      │   └── clipbox
*      │         └─ sliding-panel
*      └── item
*/

.mainnav {

  &__item {
    &--push-right {
      margin-inline-start: auto;
    }
  }

  // .mainnav
  //    └ Mobile
  @media (max-width: (breakpoints.$md)) {
    margin-block-start: 0;
    padding: var(--page-margin);
    list-style: none;
    display: flex;
    flex-direction: column;
    transition: transform var(--transition-timing) var(--transition-timing-function);

    &:has([aria-expanded="true"]) {
      // @todo: Does not yet work in Firefox
      transform: translateX(-100%);
    }

    &__link,
    &__toggle-button,
    &__close-button {
      padding-block-start: var(--space-100);
      padding-block-end: var(--space-100);
      display: flex;
      width: 100%;
      align-items: center;
      text-decoration: none;
    }

    &__toggle-button {
      transition: visibility var(--transition-timing);
      justify-content: space-between;

      .subnav:has([aria-expanded="true"]) &:not(.subnav__close) {
        // @todo: Firefox
        visibility: hidden;
      }

      &::after {
        content: "";
        background-color: var(--color-white);
        -webkit-mask: url("/typo3conf/ext/typo3_vite_demo/Resources/Public/Icons/sprite.svg#chevron-right-view");
        mask: url("/typo3conf/ext/typo3_vite_demo/Resources/Public/Icons/sprite.svg#chevron-right-view");
        display: block;
        width: 0.375rem;
        height: 0.625rem;
        transition: transform .25s ease-in-out;
        transform: translateX(0);
      }

      &:hover::after {
        transform: translateX(.375rem);
      }
    }

    &__close-button {
      gap: var(--space-100);

      &::before {
        content: "";
        background-color: var(--color-white);
        -webkit-mask: url("/typo3conf/ext/typo3_vite_demo/Resources/Public/Icons/sprite.svg#chevron-right-view");
        mask: url("/typo3conf/ext/typo3_vite_demo/Resources/Public/Icons/sprite.svg#chevron-right-view");
        display: block;
        width: 0.375rem;
        height: 0.625rem;
        transition: transform .25s ease-in-out;
        transform: translateX(0) rotate(180deg);
      }

      &:hover::before {
        transform: translateX(-.375rem) rotate(180deg);
      }
    }

    &__clipbox {
      position: absolute;
      top: 0;
      left: 100%;
      width: 100%;
      bottom: 0;
      background-color: var(--color-background);
      transition: visibility var(--transition-timing);

      [aria-expanded="false"] + & {
        visibility: hidden;
      }
    }

    &__item {
      &--overview {
        text-transform: uppercase;
      }

      &--desktop-only {
        @media (max-width: (breakpoints.$md)) {
          display: none;
        }
      }
    }
  }

  // .mainnav
  //    └ Desktop
  @media (min-width: (breakpoints.$md + 1px)) {
    list-style: none;
    display: flex;
    flex-direction: row;
    align-items: center;
    gap: var(--space-50);
    margin: 0;
    padding-inline-start: 0;

    &__link {
      text-decoration: none;
    }

    &__clipbox {
      overflow: hidden;
      transition: visibility var(--transition-timing);
      position: fixed;
      top: var(--header-height);
      left: 0;
      right: 0;

      [aria-expanded="false"] + & {
        visibility: hidden;
      }
    }

    &__sliding-panel {
      transition: transform var(--transition-timing) var(--transition-timing-function), visibility var(--transition-timing);
      background-color: var(--color-background);

      [aria-expanded="false"] + .mainnav__clipbox & {
        transform: translatey(-100%);
        visibility: hidden;
      }

      > * {
        max-width: var(--header-max-content-width);
        margin-inline: auto;
      }

    }

    &__toggle-button {
      &--chevron {
        display: flex;
        align-items: center;
        gap: 0.35em;

        &::after {
          content: "";
          background-color: var(--color-white);
          -webkit-mask: url("/typo3conf/ext/typo3_vite_demo/Resources/Public/Icons/sprite.svg#chevron-right-view");
          mask: url("/typo3conf/ext/typo3_vite_demo/Resources/Public/Icons/sprite.svg#chevron-right-view");
          display: block;
          width: 0.375rem;
          height: 0.625rem;
          transform: rotate(90deg);
        }

        &[aria-expanded="true"]::after {
          transform: rotate(-90deg);
        }
      }
    }
  }
}

.level-two {
  list-style: none;
  padding: var(--page-margin);
  display: flex;
  flex-direction: column;

  &__link {
    padding-block-start: var(--space-100);
    padding-block-end: var(--space-100);
    display: flex;
    width: 100%;
    align-items: center;
    text-decoration: none;
  }

  &__item {
    &--overview {
      text-transform: uppercase;
      letter-spacing: .4em;
    }
  }
}
